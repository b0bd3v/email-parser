<!DOCTYPE html>
<html>
  <head>
    <title>EmailParser</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>
    <%= stylesheet_link_tag "tailwind", "data-turbo-track": "reload" %>

    <%= stylesheet_link_tag "application", "data-turbo-track": "reload" %>
    <%= favicon_link_tag asset_path('favicon.svg') %>
    <%= javascript_importmap_tags %>
  </head>

  <body class="bg-gray-950 text-white antialiased">
    <% if user_signed_in? %>
      <%= render 'layouts/navbar' %>
    <% end %>

    <main class="<%= user_signed_in? ? 'max-w-screen-xl mx-auto mt-32 px-5 flex flex-col' : 'w-full relative' %>">
      <!-- Flash Messages / Toast Container -->
      <% if notice.present? || alert.present? %>
        <div class="fixed top-5 left-1/2 transform -translate-x-1/2 z-[100] w-full max-w-lg px-4 space-y-3 pointer-events-none">
          <% if notice.present? %>
            <div data-controller="removable" class="pointer-events-auto flex items-center p-4 text-sm text-blue-800 rounded-xl bg-white/90 backdrop-blur-sm border border-blue-200 shadow-xl dark:bg-gray-800/90 dark:text-blue-400 dark:border-blue-800 transition-all animate-fade-in-down" role="alert">
              <svg class="flex-shrink-0 inline w-5 h-5 me-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20">
                <path d="M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5ZM9.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM12 15H8a1 1 0 0 1 0-2h1v-3H8a1 1 0 0 1 0-2h2a1 1 0 0 1 1 1v4h1a1 1 0 0 1 0 2Z"/>
              </svg>
              <div class="flex-1 font-medium"><%= notice %></div>
              <button type="button" data-action="click->removable#remove" class="ms-auto -mx-1.5 -my-1.5 bg-blue-50 text-blue-500 rounded-lg focus:ring-2 focus:ring-blue-400 p-1.5 hover:bg-blue-200 inline-flex items-center justify-center h-8 w-8 dark:bg-gray-800 dark:text-blue-400 dark:hover:bg-gray-700" aria-label="Close">
                <span class="sr-only">Close</span>
                <svg class="w-3 h-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 14">
                  <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"/>
                </svg>
              </button>
            </div>
          <% end %>

          <% if alert.present? %>
            <div data-controller="removable" class="pointer-events-auto flex items-center p-4 text-sm text-red-800 rounded-xl bg-white/90 backdrop-blur-sm border border-red-200 shadow-xl dark:bg-gray-800/90 dark:text-red-400 dark:border-red-800 transition-all animate-fade-in-down" role="alert">
              <svg class="flex-shrink-0 inline w-5 h-5 me-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 20 20">
                <path d="M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5ZM9.5 4a1.5 1.5 0 1 1 0 3 1.5 1.5 0 0 1 0-3ZM12 15H8a1 1 0 0 1 0-2h1v-3H8a1 1 0 0 1 0-2h2a1 1 0 0 1 1 1v4h1a1 1 0 0 1 0 2Z"/>
              </svg>
              <div class="flex-1 font-medium"><%= alert %></div>
              <button type="button" data-action="click->removable#remove" class="ms-auto -mx-1.5 -my-1.5 bg-red-50 text-red-500 rounded-lg focus:ring-2 focus:ring-red-400 p-1.5 hover:bg-red-200 inline-flex items-center justify-center h-8 w-8 dark:bg-gray-800 dark:text-red-400 dark:hover:bg-gray-700" aria-label="Close">
                <span class="sr-only">Close</span>
                <svg class="w-3 h-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 14">
                  <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"/>
                </svg>
              </button>
            </div>
          <% end %>
        </div>
      <% end %>

      <% if user_signed_in? %>
        <div class="bg-gray-900/60 backdrop-blur-xl border border-gray-800/50 rounded-3xl shadow-2xl p-8 min-h-[calc(100vh-8rem)]">
          <%= yield %>
        </div>
      <% else %>
        <%= yield %>
      <% end %>
    </main>
  </body>
</html>
